HTML   CMS Energy Corporation - Contact Us      [if lte IE 8]>
<link id="respond-proxy" rel="respond-proxy" media="screen" href="//s26.q4cdn.com/888045447/files/js/respond-proxy.html" />
<link id="respond-redirect" rel="respond-redirect" media="screen" href="https://www.cmsenergy.com/js/respond.proxy.gif" />
<![endif]           [if lte IE 8]>
<script type="text/javascript" src="//s26.q4cdn.com/888045447/files/js/respond.min.js"></script>
<script type="text/javascript" src="https://www.cmsenergy.com/js/respond.proxy.js"></script>
<![endif]  var trackingCodes = [{qualifier: 'Q4', trackingCode: 'UA-56726059-1'}];
var ipSessStorageKey = 'ipApiInfo';
// The Q4 Snowplow lib which Q4Blizzard utilises also makes a call to the ip-api and sets the info in LS.
// So it's beneficial to check there too, to prevent redundant calls to ip-api.
var q4SnowplowLib_ipLocStorageKey = 'q4spisp';
var ipJsonStringified = sessionStorage.getItem(ipSessStorageKey) || localStorage.getItem(q4SnowplowLib_ipLocStorageKey);

// Only load google analytics if we have tracking codes configured
if (trackingCodes.length) {
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
            m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
}

(function ($) {
  const initialisedV4Codes = [];

  function initGaTracking(isp, org) {
    // Only load google analytics if we have tracking codes configured
    if (!trackingCodes.length) return;

    isp = isp || '(not set)';
    org = org || '(not set)';
    $.each(trackingCodes, function (i, data) {
      if (data.qualifier === "Q4") {
        ga('create', data.trackingCode, 'auto'); // Q4 tracker
        ga('set', { 'dimension1': isp });
        ga('set', { 'dimension2': org });
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview', { 'page': location.pathname + location.search + location.hash }); // send pageview to Q4 tracker
      } else if (data.qualifier === 'V4Client') {
        // This is to prevent a script tag from being added more than once
        if (initialisedV4Codes.indexOf(data.trackingCode) === -1) {
          // Add gtag script to DOM
          const gtagScriptTag = document.createElement("script");
          gtagScriptTag.async = true;
          gtagScriptTag.src = "https://www.googletagmanager.com/gtag/js?id=" + data.trackingCode;
          document.head.appendChild(gtagScriptTag);

          // Instance this gtag
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          const secureCookieTag = 'SameSite=None;Secure';
          gtag("js", new Date());
          gtag('set', {cookie_flags: secureCookieTag});
          gtag("config", data.trackingCode, { anonymize_ip: true });
          initialisedV4Codes.push(data.trackingCode);
        }
      } else {
        ga('create', data.trackingCode, 'auto', { 'name': data.qualifier }); // Client tracker
        ga(data.qualifier + '.set', 'anonymizeIp', true);
        ga(data.qualifier + '.send', 'pageview', { 'page': location.pathname + location.search + location.hash }); // send pageview to Client tracker
      }
    });
  }

  if (ipJsonStringified) {
    try {
      var ipJsonParsed = JSON.parse(ipJsonStringified);
      initGaTracking(ipJsonParsed.isp, ipJsonParsed.org);
    } catch (e) {
      console.error('Failed to JSON parse IP API session storage data\n', e);
      initGaTracking();
    }
  } else {
    $.getJSON('https://pro.ip-api.com/json/?key=6KddQSe576qrfNb&fields=isp,org')
      .done(function (ipJson) {
        sessionStorage.setItem(ipSessStorageKey, JSON.stringify(ipJson));
        initGaTracking(ipJson.isp, ipJson.org);
      })
      .fail(function () {
        initGaTracking();
      });
  }
})(jQuery);

(function () {
  Q4Blizzard.initProps({
    appId: "Q4WebCmsenergy2020",
    collectorUrl: "https://" + window.location.hostname + "/x0k461",
    cookieName: "__uxq412__",
    organizationId: "e1e2b672-735b-4fee-bdab-5e18efd01e27",
    postPath: "/e6c1b/xc9",
    productVersion: "5.107.0.6",
  });

  Q4Tracker.init("True");
})();               //<![CDATA[
var theForm = document.forms['fmForm1'];
if (!theForm) {
    theForm = document.fmForm1;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
//]]>   //<![CDATA[
function GetViewType(){ return '2'; }
function GetRevisionNumber(){ return '1'; }
function GetLanguageId(){ return '1'; }
function GetVersionNumber(){ return '5.107.0.6'; }
function GetPoweredBy(){return 'q4inc';}
function GetViewDate(){{ return ''; }}
function GetSignature(){{ return ''; }}
//]]>   //<![CDATA[
function WebForm_OnSubmit() {
if (typeof(ValidatorOnSubmit) == "function" && ValidatorOnSubmit() == false) return false;
return true;
}
//]]>                 $(document).ready(function(){

        $('.NavTrigger').click(function(){
            if ($(this).hasClass('active')){
                $(this).removeClass('active');
            } else {
                $(this).addClass('active');
            }
            $('.RespNav').toggleClass('active');  
        });

        $('.RespNav .level1 > li.has-children > a').append('<span class="drop-icon"></span>');
        $('.RespNav .level1 > li.has-children > a span').on('click',function(e){
            e.preventDefault(); 
            $(this).parent().toggleClass('active').next().slideToggle().parent().toggleClass('active');
        });


    });   About  Cultural Values Leadership  Board of Directors Officers  Consumers Energy  Electric Business Natural Gas Business  NorthStar Clean Energy  Investors  Corporate Overview Events & Presentations News Releases Glossary Financial Information  Annual Reports Proxy Materials Quarterly Earnings Supplemental  Regulatory Filings  CMS Energy SEC Filings Consumers Energy SEC Filings Rate Case Summaries Consumers 2014 Securitization Funding LLC  Interactive Analyst Center Stock Information  Analyst Coverage  Investor Resources  Contact IR & Email Contacts Information Request Receive Email Alerts Online Investor Kit   Shareowner Services  Stock Plan Prospectus Tax Information Manage Your Account Online Equiniti Trust Company Shareowner Contact Information Direct Stock Purchase Plan  Corporate Governance  Our View on Governance Directors  Directors Details  Officers Governance Documents Contact the Board Compliance & Ethics Political Engagement  Sustainability  Sustainability Overview SASB Index For Consumers Energy – Electric Utilities & Power Generation SASB Index For Consumers Energy – Gas Utilities & Distributors UNSDG TCFD 2021 ESG Scorecard  Careers    Mobile Search           Google Tag Manager   (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push(
{'gtm.start': new Date().getTime(),event:'gtm.js'}

);var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PHRSZG');  End Google Tag Manager             CMS Energy Stock Price    54.29  + 0.00  + 0%  Volume:  1,536,771   10.17.23 04:00 ET   About  Cultural Values Leadership  Board of Directors Officers  Consumers Energy  Electric Business Natural Gas Business  NorthStar Clean Energy  Investors  Corporate Overview Events & Presentations News Releases Glossary Financial Information  Annual Reports Proxy Materials Quarterly Earnings Supplemental  Regulatory Filings  CMS Energy SEC Filings Consumers Energy SEC Filings Rate Case Summaries Consumers 2014 Securitization Funding LLC  Interactive Analyst Center Stock Information  Analyst Coverage  Investor Resources  Contact IR & Email Contacts Information Request Receive Email Alerts Online Investor Kit   Shareowner Services  Stock Plan Prospectus Tax Information Manage Your Account Online Equiniti Trust Company Shareowner Contact Information Direct Stock Purchase Plan  Corporate Governance  Our View on Governance Directors  Directors Details  Officers Governance Documents Contact the Board Compliance & Ethics Political Engagement  Sustainability  Sustainability Overview SASB Index For Consumers Energy – Electric Utilities & Power Generation SASB Index For Consumers Energy – Gas Utilities & Distributors UNSDG TCFD 2021 ESG Scorecard  Careers    var replace = {
    'http://d1lge852tjjqow.cloudfront.net/CIK-0000811156/166db641-c890-4970-9d1e-b09b265d424e.pdf' : '/files/doc_financials/sec/2015/CMS-Energy-2015-Proxy-Statement_v001_y96c6x.pdf',

//'http://d1lge852tjjqow.cloudfront.net/CIK-0000811156/810c93ec-038b-4744-977f-bc6c8d18da30.pdf' : '/files/doc_financials/sec/2016/20160314-CMS-Proxy-FINAL-with-links-and-Proxy-Card-(2).pdf'


};

var remove = [
    'http://d1lge852tjjqow.cloudfront.net/CIK-0000811156/fe22267d-fef0-4c28-950b-92263c73fb78.rtf'
];

// for the filing list page
$(document).ajaxComplete(function() {
    $.each(replace, function(src, repl) {
        $('a[href*="'+src+'"]').attr('href', repl);
    });

    $.each(remove, function (i, src) {
        $('a[href*="' + src + '"]').parent().hide();
    });
});

// for the filing details page
$(document).ready(function() {
    $.each(replace, function(src, repl) {
        $('a[href*="'+src+'"]').attr('href', repl);
    });

    $.each(remove, function (i, src) {
        $('a[href*="' + src + '"]').parent().hide();
    });
});   if (location.href == 'http://www.cmsenergy.com/investor-relations/') {
          window.location = "http://www.cmsenergy.com/investor-relations/corporate-overview/default.aspx";
     }       Home > Contact Us     About  Cultural Values Leadership  Board of Directors Officers  Consumers Energy  Electric Business Natural Gas Business  NorthStar Clean Energy  Investors  Corporate Overview Events & Presentations News Releases Glossary Financial Information  Annual Reports Proxy Materials Quarterly Earnings Supplemental  Regulatory Filings  CMS Energy SEC Filings Consumers Energy SEC Filings Rate Case Summaries Consumers 2014 Securitization Funding LLC  Interactive Analyst Center Stock Information  Analyst Coverage  Investor Resources  Contact IR & Email Contacts Information Request Receive Email Alerts Online Investor Kit   Shareowner Services  Stock Plan Prospectus Tax Information Manage Your Account Online Equiniti Trust Company Shareowner Contact Information Direct Stock Purchase Plan  Corporate Governance  Our View on Governance Directors  Directors Details  Officers Governance Documents Contact the Board Compliance & Ethics Political Engagement  Sustainability  Sustainability Overview SASB Index For Consumers Energy – Electric Utilities & Power Generation SASB Index For Consumers Energy – Gas Utilities & Distributors UNSDG TCFD 2021 ESG Scorecard  Careers    $(function() {
        $('a[href*="apps.indigotools.com/IR/IAC/?Ticker=CMS&Exchange=NYSE"]').on('click', function(e) {
            e.preventDefault();
            $('#Disclaimer').find('#proceed').attr('href', $(this).attr('href'));
            $.fancybox({
                href: '#Disclaimer',
                maxWidth: 960,
                maxHeight: 600,
                padding: 25
            });
        });
        $('#back').click(function(event) {
            event.preventDefault();
            $.fancybox.close();
        });
    });

    $(function() {
        $('a[href*="https://bcbsm.sapphiremrfhub.com/tocs/current/consumers_energy"]').on('click', function(e) {
            e.preventDefault();
            $('#TransparencyDisclaimer').find('#proceed').attr('href', $(this).attr('href'));
            $.fancybox({
                href: '#TransparencyDisclaimer',
                maxWidth: 960,
                maxHeight: 600,
                padding: 25
            });
        });
    });

    $(function() {
        $('a[href*="https://health1.aetna.com/app/public/#/one/insurerCode=AETNACVS_I&brandCode=ALICSI/machine-readable-transparency-in-coverage?searchTerm=64127&lock=true%20[health1.aetna.com]"]').on('click', function(e) {
            e.preventDefault();
            $('#TransparencyDisclaimer').find('#proceed').attr('href', $(this).attr('href'));
            $.fancybox({
                href: '#TransparencyDisclaimer',
                maxWidth: 960,
                maxHeight: 600,
                padding: 25
            });
        });
    });     Disclaimer  Please note that you are now entering a website directly or indirectly maintained by a third party (the "External Site") and that you do so at your own risk.  CMS Energy, Corp. (“CMS”) has no control over the External Site, any data or other content contained therein or any additional linked websites. The link to the External Site is provided for convenience purposes only. By clicking “Accept” you acknowledge and agree that neither CMS nor third party provider Virtua Research, Inc. (“Virtua) is responsible, or accepts or assumes any responsibility or liability whatsoever for, the content, the data or the technical operation of the Linked Site. Further, by entering the External Site, you also acknowledge and agree that you completely and irrevocably waive any and all rights and claims against CMS and Virtua and further acknowledge and agree that in no event shall CMS or Virtua, its officers, employees, directors and agents be liable for any (i) indirect, consequential, incidental, special, compensatory or punitive damages, (ii) damages for loss of income, loss of business profits, business interruption, loss of data or business information, loss of or damage to property, (iii) claims of third parties, or (iv) other pecuniary loss, arising out of or related to the Legal Notice, this disclaimer or the External Site  By entering the External Site, you further acknowledge and agree that the disclaimer of warranties and limitations of liability set out in this disclaimer shall apply regardless of the causes, circumstances or form of action giving rise to the loss, damage, claim or liability, even if such loss, damage, claim or liability is based upon breach of contract (including, without limitation, a claim of fundamental breach or breach of a fundamental term), tort (including, without limitation, negligence), strict liability or any other legal or equitable theory, and even if CMS and Virtua are advised of the possibility of the loss, damage, claim or liability. The waiver and release specifically includes, without limitation, any and all rights and claims pertaining to the processing of personal data, including but not limited to any rights under any applicable data protection statute(s). If in any jurisdiction, any part of this disclaimer is held to be unenforceable by a court of competent jurisdiction, such part of this disclaimer shall be restricted or eliminated to the minimum extent and the remaining disclaimer shall otherwise remain in full force and effect.  Please note the information presented is deemed representative at the time of its original release. Changes in historical information may occur due to adjustments in accounting and reporting standards & procedures.  Non-GAAP Information  In addition to disclosing results determined in accordance with GAAP, CMS may also disclose certain non-GAAP and pro forma non-GAAP results of operations, including net income, earnings per share, and operating income that make certain adjustments or exclude certain charges and gains that are outlined in the schedules included in this website. CMS provides historical financial results on both a GAAP and non-GAAP basis. Management views adjusted earnings as a key measure of the company’s present operating financial performance and uses adjusted earnings for external communications with analysts and investors. Internally, the company uses adjusted earnings to measure and assess performance. Adjustments could include items such as discontinued operations, asset sales, impairments, restructuring costs, regulatory items from prior years, or other items. Because the company is not able to estimate the impact of specific line items, which have the potential to significantly impact, favorably or unfavorably, the company’s reported earnings in future periods, the company is not providing reported earnings guidance nor is it providing a reconciliation for the comparable future period earnings.  CMS and Virtua also take no responsibility for third party pricing data provided for informational purposes and certain ratio results formulated from the provided third party pricing data. The non-GAAP information is not prepared in accordance with GAAP and may not be comparable to non-GAAP information used by other companies. The non-GAAP information should be considered supplemental information to assist in fully understanding our business results, rather than as a substitute for the reported earnings.   A reconciliation of each of these non-GAAP measures to the most directly comparable GAAP measure is included as a separate link and also posted on the CMS website at www.cmsenergy.com .   Accept | Decline         Important Notes   The information contained in this Machine-Readable File may be difficult to access without certain technology.  These files may be large and require a computer that can download at least up to 1TB (terabyte) of data. Most modern hard drives store half of this amount of data. Based on your computer's storage and hard drive, attempting to open or download large files may cause instabilities in Windows, cause performance issues resulting in downloads that could take hours, days or weeks depending on the file size and hard drive combination. For reference: 1TB = 243 high-definition streaming movies (average 2 hours per movie).    This mandate is a building block for future customer-facing mandates, including the Price Transparency Tool and the Advanced Explanation of Benefits.  The data in the files may not be useful for the average consumer. For example, facilities that are paid based on a percent of charge will not have a dollar amount representing the amount paid for a service.  The machine-readable files will be updated monthly to ensure accuracy of the data and reflect changes in pricing and regulatory requirements.   I Understand          Contact Us    CONTACT US  Corporate Headquarters  CMS Energy Corporation One Energy Plaza Jackson, MI 49201 (517) 788-0550  info@cmsenergy.com   Consumers Energy Company  One Energy Plaza Jackson, MI 49201 (517) 788-0550  For Consumers Energy customer contact information, click here   CMS Enterprises Company  One Energy Plaza Jackson, MI 49201 (517) 768-3376  cmsenterprises@cmsenergy.com    EnerBank ® USA  1245 Brickyard Road Suite 600 Salt Lake City, UT 84106 (800) 390-1220  www.enerbank.com   For additional EnerBank contact information, click here    Board of Directors  To view our Board of Directors team click here    Shareowner Services  CMS Energy Corporation has appointed Wells Fargo Bank, N.A. (Wells Fargo or Wells Fargo Shareowner Services) as its transfer agent, registrar and dividend disbursing agent and will be administering the CMS Energy Stock Purchase Plan (effective July 21, 2014). Click here    Investor Relations  Contact investrel@cmsenergy.com For specific investor items, please fill out the Request Information Form.    Media  Contact Megan Brown, Senior Director of Strategic Communications and Public Relations at (517) 788-6538, Katie Carey, Director of Media Relations at (517) 788-2395, or Brian Wheeler, Senior Public Information Director at (517) 788-2394, or email newsroom@cmsenergy.com   Please use the telephone numbers listed for a timely response. E-mail is not monitored outside of normal business hours or when recipients are out of the office.   Careers   e-recruiting@cmsenergy.com For job postings, visit here    General Information   info@cmsenergy.com           Footer Links   Site Map  |  Privacy  |  Contact Us  |  Security  |  Consumers Energy  |  Terms of Use      Top Destinations   Investors  News Releases  Careers  Latest Presentation  Sustainability  Leadership      Subscribe to our alerts   To opt-in for investor email alerts, please enter your email address in the field below and select at least one alert option. After submitting your request, you will receive an activation email to the requested email address. You must click the activation link in order to complete your subscription. You can sign up for additional alert options at any time. At COMPANY NAME, we promise to treat your data with respect and will not share your information with any third party. You can unsubscribe to any of the investor alerts you are subscribed to by visiting the ‘unsubscribe’ section below. If you experience any issues with this process, please contact us for further assistance. By providing your email address below, you are providing consent to COMPANY NAME to send you the requested Investor Email Alert updates. * Required      Sign up for Email Alerts    Email Address  *         Mailing Lists     Mailing Lists  *        Press Release   SEC Filing   Presentation   Event   End of Day Stock Quote           function onLoad__ctrl0_ctl48_recaptcha() {
            grecaptcha.render('_ctrl0_ctl48_btnSubmit', {
                'sitekey': '6LcKf8wZAAAAADYEeFvKUvdj80FVct5G98mSJ29W',
                'callback': 'onSubmit__ctrl0_ctl48_recaptcha',
                'size': 'invisible'
            });
        }

        function onSubmit__ctrl0_ctl48_recaptcha(token) {
            var captchaTokenField = document.getElementById('_ctrl0_ctl48_recaptcha_hdnCaptchaToken');

            captchaTokenField.value = token;
            __doPostBack('_ctrl0$ctl48$btnSubmit', "");
        }   .grecaptcha-badge {
            display: none !important;
        }        Unsubscribe   This site is protected by reCAPTCHA and the Google Privacy
           Policy and Terms of Service apply.        Email Alert Sign Up Confirmation      .q4l-loading-spinner {
      border: 16px solid #f3f3f3;
      border-radius: 50%;
      border-top: 16px solid #3498db;
      width: 120px;
      height: 120px;
      -webkit-animation: spin 2s linear infinite; /* Safari */
      animation: spin 2s linear infinite;
    }
    
    /* Safari */
    @-webkit-keyframes spin {
      0% { -webkit-transform: rotate(0deg); }
      100% { -webkit-transform: rotate(360deg); }
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }   function showMessage(message, targetElementId = "_ctrl0_ctl48_divEditSubscriberConfirmation") {
        $("#" + targetElementId).text(message);
        $("#" + targetElementId).show();
    }

    function getCookie(name) {
        var nameEQ = name + "=";
        var ca = document.cookie.split(";");
        for (var i = 0; i < ca.length; i++) {
            var c = ca[i];
            while (c.charAt(0) == " ") c = c.substring(1, c.length);
            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
        }
        return null;
    }

    // see STD-647
    (async function () {
        const q4lTriggerClientID = window.localStorage.getItem("q4l_trigger_clientID");
        // we check q4lTriggerClientID so that when there are multiple mailing lists,
        // only the one that the user submitted will have its view changed so there is
        // a cleaner UX
        const didTriggerFlow = q4lTriggerClientID === "_ctrl0_ctl48";
        let idToken = window.location.hash.includes("id_token") ? window.location.hash.replace("#id_token=", "") : null;
        idToken = idToken ?? getCookie(Q4Login.StorageKeys.SessionToken);
        if (window.location.hash.includes("error")) {
            const errorCode = window.location.hash.replace("#error=", "");
            if (errorCode === "401.1" && didTriggerFlow) {
                const message = "Your email is not verified. Please click the verification link we sent to your inbox.";
                $("#_ctrl0_ctl48_divModuleContainer").hide();
                showMessage(message);
            }
        }
        else if (window.location.hash.includes("message")) {
            const message = decodeURIComponent(window.location.hash.replace("#message=", ""));
            if (didTriggerFlow) {
                showMessage(message, "_ctrl0_ctl48_validationsummary");
            }
        }
        else if (idToken) {
            // default message
            let message = "Unable to subscribe using your Q4 Account, please try again.";
            const mailingListSelections = localStorage.getItem("q4l_mailing_selections");
            if (!!mailingListSelections && didTriggerFlow) {
                try {
                    // hide mailing list selections, then show spinner
                    $("#_ctrl0_ctl48_divModuleContainer").hide();
                    $("#_ctrl0_ctl49-spinner").show();

                    // build and make request
                    const requestOptions = {
                        method: "PUT",
                        headers: {
                            "Content-Type": "application/json",
                            "Authorization": "Bearer " + idToken
                        },
                        body: mailingListSelections
                    };
                    const publicApi = "https://cmsenergy2020.studio.q4api.com/api/MailingList";
                    const response = await fetch(publicApi, requestOptions)
                        .catch(error => console.log(error));
                    const subscribeResult = await response.json();
                    if (subscribeResult) {
                        message = subscribeResult.data;
                    }
                }
                catch (ex) {
                    console.log(ex);
                }
                localStorage.removeItem("q4l_mailing_selections");
                localStorage.removeItem("q4l_email");
                // set the output message then show it
                showMessage(message);
            }
            else if (window.location.hash.includes("id_token") && !mailingListSelections && didTriggerFlow) {
                // if there is no mailing list selections at this point, then
                // something is up.
                showMessage(message);
            }
        }

        // clean up
        $("#_ctrl0_ctl49-spinner").hide();
    })();    back to beginning of page   $(document).ready(function(){
     $('.top').on('click', function(){
       $('html, body').animate({scrollTop : 0},800);
       return false;
     });
   });     <script src="//s26.q4cdn.com/888045447/files/js/jquery-cycle2-min.js"></script>  var sliders = [{
    class: 'Corp',
    rotate: false,
// }, {
//     IR sliders are controlled in the Global Module "Slider DL Widget"
//     class: 'IR',
//     rotate: false
}];

$(function() {
    $.each(sliders, function(i, slider) {
        var timer = slider.rotate ? 8000 : 0;
        if(!slider.rotate) {
            // $('.' + slider.class + '.Slider .slide-item').not(':first').remove();
            $('.SliderInner').cycle('stop');
            $('.module-slider #pager').addClass('js--hidden');
        }
        
        $('.' + slider.class + '.Slider .SliderInner').cycle({
            fx: 'fade',
            autoplay: false,
            prev: '.prev',
            next: '.next',
            slides: '.slide-item',
            cleartype: false,
            paused: true,
            timeout: timer
        });
    });
});      var year = new Date().getFullYear();
    $('span.footerYear').text(year);

    var isMobile = {
        Android: function () {
            return navigator.userAgent.match(/Android/i);
        },
        BlackBerry: function () {
            return navigator.userAgent.match(/BlackBerry/i);
        },
        iOS: function () {
            return navigator.userAgent.match(/iPhone|iPad|iPod/i);
        },
        Opera: function () {
            return navigator.userAgent.match(/Opera Mini/i);
        },
        Windows: function () {
            return navigator.userAgent.match(/IEMobile/i) || navigator.userAgent.match(/WPDesktop/i);
        },
        any: function () {
            return (this.Android() || this.BlackBerry() || this.iOS() || this.Opera() || this.Windows());
        }
    };
    var androidTap = function (selector) {
        if (isMobile.any()) {
            $(selector).find('> li.has-children > a').on('click', function (e) {
                if (!$(this).parent().hasClass('js--hover')) {
                    e.preventDefault();
                    $(this).parent().siblings().removeClass('js--hover').find('>ul').hide();
                    $(this).parent().addClass('js--hover').find('>ul').show();
                }
            })
        } else {
            $(selector).find('> li.has-children').hover(
                function () {
                    $(this).addClass('js--hover').find('>ul').show();
                },
                function () {
                    $(this).removeClass('js--hover').find('>ul').hide();
                }
            );
        }
    };
    androidTap('.MainNav .level1');
    // search placeholder
    function lang_focus(name, element) {
        $(element).val(name);
        $(element).focus(function () {
            if (element.value == name) element.value = '';
        });
        $(element).blur(function () {
            if (!element.value.length) element.value = name;
        });
    }

    $(document).ready(function () {
        $('.QuickLinks.link-to-new a').attr('target', "_blank");
        $('table.MailingListListTable table tr:first-child td input').prop('checked', true);

        // fancybox
        $("a.fancybox").fancybox();

        $('a.fancyboxiframe').fancybox({
            type: 'iframe',
            'height': 428,
            'width': 712,
            helpers: {
                overlay: {
                    locked: false
                }
            }
        });

        $('.SecNav .level2 > .has-children > a').removeAttr("href");

        $(".Breadcrumb:contains('®')").html(function (_, html) {
            return html.replace(/(®)/g, '<sup>$1</sup>')
        });

        // search
        $('.PaneHeader .ModuleSearch, .PaneNavigation .MobileSearch').find('input[type="text"]').filter(
            function () {
                var name = "Search";
                lang_focus(name, this);
            });

        $('.PaneHeader .ModuleSearch input[type="text"]').on('keypress', function (e) {
            if (e.which == 13) {
                e.preventDefault();
                window.location = '/Search-Results/default.aspx?SearchTerm=' + encodeURI($(this).val());
            }
        });


        // mobile search
        $('.MobileSearch h1').on('click', function () {
            var $this = $(this);
            if ($this.hasClass('active')) {
                $this.removeClass('active');
                $this.parent().removeClass('open');
                $this.next().stop(true, true).fadeOut(200);
                $this.parent().stop(true, true).animate({
                    width: "10px"
                }, 500);
            } else {
                $this.addClass('active');
                $this.parent().addClass('open');
                $this.parent().stop(true, true).animate({
                    width: "140px"
                }, 300);
                $this.next().delay(200).stop(true, true).fadeIn(200);
            }
        });


        // move modules
        /* $(window).bind('load', function(){
             if ($(window).width() < 767) {
                 $('.InvestorTools, .Contacts').prependTo('.PaneLeft');
             } else if ($(window).width() > 768) {
                 $('.InvestorTools, .Contacts').appendTo('.PaneRight');
             }
             $(window).resize(function() {
                 if ($(window).width() < 767) {
                     $('.InvestorTools, .Contacts').prependTo('.PaneLeft');
                 } else if ($(window).width() > 768) {
                     $('.InvestorTools, .Contacts').appendTo('.PaneRight');
                 }
             });
         });*/


        // banners
        $('.Banner').appendTo($('.HeaderImage'));
        $(window).bind('load', function () {
            $('.Banner').height($('.HeaderImageContainer').height());
        });
        $(window).resize(function () {
            $('.Banner').height($('.HeaderImageContainer').height());
        });
        $('.hyperlink').prependTo($('.HeaderImage'));
        $('.HeaderImage img').addClass('img');
        $('.HeaderImage .img, .Banner').appendTo('.hyperlink');


        $(document).ready(function () {
            $(".accountabilityReport").click().fancybox({
                fitToView: false,
                width: '90%',
                height: '90%',
                autoSize: false,
                closeClick: false,
                openEffect: 'none',
                closeEffect: 'none',
                iframe: {
                    scrolling: 'auto',
                    preload: true
                }
            });
        });
    });
    /*
    var replaced = [
    {
        url: 'http://d1lge852tjjqow.cloudfront.net/CIK-0000811156/bb77e77b-d33f-453c-943d-2f7e09dde80f.rtf?noexit=true', 
        file: '/files/sec/May-15-8-K.rtf'
    },
    {
        url: 'http://d1lge852tjjqow.cloudfront.net/CIK-0000811156/bb77e77b-d33f-453c-943d-2f7e09dde80f.rtf', 
        file: '/files/sec/May-15-8-K.rtf'
    },
    ];
    
    // for the filing list page
    $(document).ajaxComplete(function() {
        $.each(replaced, function(src, data) {
            $('a[href*="'+data.url+'"]').attr('href', data.file);
        });
    });
    
    // for the filing details page
    $(document).ready(function() {
        $.each(replaced, function(src, data) {
            $('a[href*="'+data.url+'"]').attr('href', data.file);
        });
    });
    */

    //accessibility - BOD page
    $('.PaneContent .Person').each(function () {
        var bio = $(this).find('.PersonName2').text();
        $(this).find('.PersonPhoto img').attr("alt", bio);
    });

    // A11Y - Navigation - <nav>s need unique identifier
    $('.MainNav').attr('aria-label', 'Main Navigation');
    $('.SecNav').attr('aria-label', 'Secondary Navigation');

    // A11Y - Footer Email Alert - remove label
    var $label = $('label[for$=_chkLists]');
    var labelText = $label.text();
    $label.parent().prepend('<span class="subscribe_list-label">' + labelText + '</span>');
    $label.remove();

    // A11Y - Email Alert - Checkboxes table
    $('.module-subscribe_table, .MailingListListTable').find('table[id$=chkLists]').attr('role', 'presentation');

    //search bar    
    $(document).ready(function () {
        //Corporate Overview page - SEC Filings - select dropdown
	       var selectId = $('.FormGroupsContainer select').attr('id');
      $('.FormGroupsContainer').prepend('<label class="sr-only form-select">Select Form type</label>');
      $('.form-select').attr('for', selectId);

        //Homepage - slick slide
        $('.slick-slide').removeAttr('aria-describedby');

        //Homepage - Press Releases
        $('.ModuleMore').html('<span class="sr-only">Read More</span>');

        //BOD, Officers pages
        $('.PaneContent .Person').each(function () {
            var bio = $(this).find('.PersonName2').text();
            $(this).find('.PersonPhoto img').attr("alt", bio);
        });

        // Label inserter
        function insertLabel(target, labelText) {
            $(target).each(function (i) {
                var id = $(this).attr('id');
                var label = $(this).attr('aria-label') || labelText;

                if (id) {
                    $('<label class="sr-only" for="' + id + '">' + label + '</label>').insertBefore(
                        this);
                } else {
                    $(this).wrap('<label></label>');
                    $('<span class="sr-only">' + label + '</span>').insertBefore(this)
                }
            });
        }

        // Footer email signup
        insertLabel('.module-subscribe_submit-button', 'Submit');

        // Navigation Search
        insertLabel('.SearchInput', 'Enter Search Text');
        insertLabel('.SearchButton', 'Submit Search');

        // A11Y - Email Alert - Checkboxes table
        // $('.module-subscribe_table, .MailingListListTable').find('table[id$=chkLists]').attr('role', 'presentation');
        // $('.MailingListListTable').find('table[id$=chkLists]').wrap('<fieldset id="subscribe-list--content"></fieldset>');
        // $('#subscribe-list--content').prepend('<label class="sr-only">Mailing List options</label>');

        // A11Y - Update Checkbox markup
        function transformSignUp(containerSelector, labelSelector, fieldsetID, legend) {
            var $container = $(containerSelector);

            // Mailing Lists
            var $mailListsContainer = $container.find('table[id$="MailingLists"]');
            var $chkListsContainer = $container.find('table[id$="chkLists"]');
            var $mailListValidationId = $mailListsContainer.find('span[id$=MailingListsValidator').attr('id');
            
            if ($mailListsContainer.find(labelSelector).parent().length) {
                legend = $mailListsContainer.find(labelSelector).parent()[0].innerHTML;
            }

            $mailListsContainer.before('<div class="MailingList-container module-subscribe_table-input"></div>');
            $container.find('.MailingList-container').append(
                '<fieldset id="' + fieldsetID + '" class="MailingList-fieldset">' +
                '<legend>' + legend + '</legend>' +
                '<div class="checkboxes-container"></div>' +
                '</fieldset>'+ 
                '<span id="'+ $mailListValidationId +'" style="display:none;"></span>'
            );

            $chkListsContainer.find('tr > td').each(function (index, checkbox) {
                $mailListsContainer.parent().find('#' + fieldsetID + ' .checkboxes-container').append((
                    '<div class="checkbox-container">' +
                    $(checkbox)[0].innerHTML +
                    '</div>'
                ));
            });

            $mailListsContainer.remove();
        }

        // transformSignUp('.footerAlerts', '.subscribe_list-label', 'footerAlerts-chkboxes',
        //     "Investor Alert Options *");
        // transformSignUp('.MailingListSignupContainer', '.MailingListsHeading', 'MailingListSignupContainer-chkboxes', "Mailing Lists *");
    });
    
    //Tabbed modules (e.g. FAQ page)
    $('.module-faq .module_item').each(function(){
          var linkId = $(this).children('a').attr('id');
          $(this).children('h3').attr('aria-controls', linkId + 'panel');
          $(this).children('h3').attr('id', linkId + 'tab');
          var ariaControls = $(this).children('h3').attr('aria-controls');
          var tabId = $(this).find('span').attr('id');
          $(this).children('.module-faq_answer').attr('id', ariaControls);
          $(this).children('.module-faq_answer').attr('describedby', tabId);
    });
    
    //FAQ page
    $('.FAQ-BackToTop a').text('back to page beginning');
    
    //Event module (Homepage, Events & Presentations)
    $('.ModuleEvent .ModuleLocation').remove();
    
    
//Code for Organics Footer Signup Form
    /**
 * Reuseable functions used on Q4 Websites
 * @class q4.app
 */

/** @lends q4.app */
var q4Defaults = {
    options: {
        /**
         * Any mailing list with this class will have their validation overwritten
         */
        mailingListSignupCls: '.module-subscribe--fancy',
        /**
         * Error message to display (i.e. mailing list signup / unsubscribe)
         */
        errorMessage: 'The following errors must be corrected',
        /**
         * Text to display if an item is required for validation
         */
        requiredText: 'is required',
        /**
         * Text to display if an entry is invalid and failed validation
         */
        invalidText: 'is invalid',
        /**
         * Text to display if captcha is required. `requiredText` and `invalidText` will often proceed this text (i.e Code is required)
         */
        captchaValidationText: 'Code',
        /**
         * Text used if a code is required.
         */
        provideCodeText: 'Please provide the code',
        /**
         * Custom template for email validation
         */
        errorTpl: (
            '<p class="module_message module_message--error">{{errorMessage}}</p>' +
            '<div>' +
            '   {{#errors}}' +
            '       <p class="module_message module_message--validation_error">&#8226; {{name}} {{message}}</p>' +
            '   {{/errors}}' +
            '</div>'
        ),
        mailingListConfig: {
            /**
             * Template to overwrite mailing list signup confirmation html.
             */
            tpl: (
                '<div id="SubscriberConfirmation" class="module module-subscribe module-subscribe--fancy dark grid_col grid_col--3-of-6 grid_col--md-1-of-2">' +
                '   <div class="module_container--outer">' +
                '       <h2 class="module_title">Email Alerts</h2>' +
                '       <div class="module_container--inner">' +
                '           <p class="module_message module_message--success"></p>' +
                '       </div>' +
                '   </div>' +
                '</div>'
            ),
            fancyOpts: {},
            hideOnConfirmation: '.module-subscribe-privacy',
            location: '.pane--footer',
            submitText: 'Submit' //this will change the text of the submit button on the on the mailing List
        },
      
    },
    
     /**
     * Validate if a string is a vaild email address
     * @param {emailAddress} [string]  An email address that will be tested against the regular expression
     * @example app.isValidEmailAddress ( 'support@q4inc.com' );
     * @return boolean
     */
    isValidEmailAddress: function (emailAddress) {
        var pattern = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,3}))$/;
        return pattern.test(emailAddress);
    },

    /**
     * Attaches a click handler to the modules submit button which will not allow
     * the form to submit without a true email address
     * @param {$el} [element]  an element containing the submit button
     * @example app.validateUnsubscribe($('.MailingListUnsubscribeContainer'));
     */
    validateUnsubscribe: function ($el) {
        var inst = this,
            $submit = $el.find('input[type="submit"]');

        $submit[0].outerHTML = $submit[0].outerHTML.replace(/^<input/, '<button') + '<span class="button_text">' + $submit[0].value + '</span></button>';

        $el.find('[type="submit"]').on('click', function (e) {
            var emailAddress = $el.find('input[id*="Email"]').val();

            if (!inst.isValidEmailAddress(emailAddress)) {
                $el.find('.module_confirmation-container').html(Mustache.render(inst.options.errorTpl, {
                    errors: [{
                        message: emailAddress.length ? inst.options.invalidText : inst.options.requiredText,
                        name: $el.find('label.module-unsubscribe_email').text()
                    }],
                    errorMessage: inst.options.errorMessage
                })).show();

                inst.scrollTo($el.find('.module_error-container'), 0);

                $el.addClass('js--invalid');
                e.preventDefault();
            }
        });

        if ($el.find('.module_confirmation-container').text().trim().length) {
            $('.module-subscribe,' + inst.options.mailingListConfig.hideOnConfirmation).not(inst.options.mailingListConfig.location + ' .module-subscribe').addClass('js--hidden');
            $el.find('.module_introduction, .module-unsubscribe_table, .module_actions').addClass('js--hidden');
            inst.scrollTo($el);
        }
    },

    /**
     * Opens the Mailing List Signup - Captcha inside a fancybox
     * @param {$el} [element] The mailing list module
     * @example app.fancySignup( '.module-subscribe' );
     */
    fancySignup: function () {
        var inst = this,
            validationLock = true,
            signup = inst.options.mailingListSignupCls,
            $signup = $(signup),
            confirm = 'div[id*="SubscriberConfirmation"]',
            $confirm = $('div[id*="SubscriberConfirmation"]'), // jshint ignore:line
            footerSuccess = inst.options.mailingListConfig.location + ' ' + confirm + ' .module_message--success',
            $footerSuccess = $(footerSuccess);

        // Subscriber Confirmation fix
        if ($confirm.is(':visible')) {
            if ($confirm.filter(':visible').closest(inst.options.mailingListConfig.location).length) {
                var successText = $confirm.filter(':visible').closest(inst.options.mailingListConfig.location).find('.module_message--success').text();
                $confirm.filter(':visible').parent().html(inst.options.mailingListConfig.tpl).find('.module_message--success').html(successText);
            }
            inst.scrollTo($('div[id*="SubscriberConfirmation"]').filter(':visible'), 0);
            if (!$footerSuccess.length) {
                $('.module-unsubscribe,' + inst.options.mailingListConfig.hideOnConfirmation).addClass('js--hidden');
            }
        }

        if (!$signup.length) {
            return;
        }

        $signup.each(function () {
            var $this = $(this);

            // If a confirmation or error message is visible on page load, scroll to the module
            if ($this.find('input.module_input').length && $this.find('input.module_input').val().length) {
                inst.scrollTo($this, 0);
            }
            // Create a second submit button to be displayed inside fancybox. Replace input type submit with button
            var $submit = $this.find('input[type="submit"]');
            $submit.addClass('js--hidden');
            $submit[0].outerHTML = $submit[0].outerHTML.replace(/^<input/, '<button') + '<span class="button_text">' + $submit[0].value + '</span></button>';
            $this.find('.module_actions').append('<button type="submit" class="button module-subscribe_submit-button module-subscribe_submit-button--fancy"><span class="button_text">' + inst.options.mailingListConfig.submitText + '</span></button>');

            $this.on('click', '.module-subscribe_submit-button--fancy', function (e) {
                e.preventDefault();
                validationLock = false;

                var $parent = $(this).closest(signup),
                    errors = inst._mailingListValidation($parent);

                if (!errors.length) {
                    $(this).closest(signup).find('.module_actions [type="submit"]').not(this).trigger('click');
                    return false;
                } else {
                    inst.scrollTo($this.find('.module_error-container'), 0);
                }

                return false;
            });

            // add aria-label attributes. unable to add required attribute because of CMS being a form and has it's own validation
            $this.find('.module_required').closest('.module-subscribe_table-input').find('input').attr("aria-required", "true");
            
            // Run validation on change
            $this.find('input, select').on('change', function () {
                if (!validationLock) {
                    inst._mailingListValidation($this);
                }
            });

            // Validate submit on enter
            $this.find('input[type="text"], input[type="email"]').on('keydown', function (e) {
                if (e.keyCode == 13) {
                    e.preventDefault();
                    $(this).closest(signup).find('.module_actions [type="submit"]').trigger('click');
                    return false;
                }
            });
        });
    },
    /**
     * Validates all required fields.
     * Used by default with fancySignup before displaying captcha.
     * Returns an array of errors
     * @param {$el} [element] The mailing list module
     */
    _mailingListValidation: function ($el) {
        var inst = this,
            errors = [];
        console.log('_mailingListValidation');
        $el.find('.js--invalid').removeClass('js--invalid');

        $el.find('.module_required').each(function () {
            var $item = $(this).closest('.module-subscribe_table-input'),
                message = inst.options.requiredText,
                field = $item.find('label:first').text(),
                validation = true;

            // Does the input exist?
            console.log('$item', $item);
            if ($item.find('input').length) {
                if ($item.hasClass('module-subscribe_email')) {
                    // Does the email address contain text?
                    if (!$item.find('input').val().length) {
                        validation = false;
                    }
                    // Is the email address valid?
                    else if (!inst.isValidEmailAddress($item.find('input').val())) {
                        validation = false;
                        message = inst.options.invalidText;
                    }
                }
                // Does the input contain text?
                else if (!$item.find('input').val().length) {
                    validation = false;
                }
            } else if ($item.find('select').length) {
                if (!$item.find('select option:selected').index()) {
                    validation = false;
                }
            } else {
                if (!$item.closest('.checkboxes-container').find('input[type="checkbox"]:checked').length) {
                    $item = $item.next();
                    validation = false;
                }
            }

            if (!validation) {
                $item.addClass('js--invalid');
                errors.push({
                    name: field,
                    message: message
                });
            }
        });

        if (errors.length) {
            $el.find('.module_error-container').html(Mustache.render(inst.options.errorTpl, {
                errors: errors,
                errorMessage: inst.options.errorMessage
            })).show();
        } else {
            $el.find('.module_error-container').html('');

        }

        return errors;
    }
};

var q4App = $.extend(true, q4Defaults, {
    options: {
        mailingListConfig: {
            tpl: (
                '<div id="SubscriberConfirmation" class="module module-subscribe module-subscribe--fancy dark grid_col grid_col--2-of-4 grid_col--lc-1-of-1 grid_col--md-1-of-1">' +
                '   <div class="module_container--outer">' +
                '       <h3 class="module_title">Investor Email Alerts</h3>' +
                '       <div class="module_container--inner">' +
                '           <p class="module_message module_message--success"></p>' +
                '       </div>' +
                '   </div>' +
                '</div>'
            ),
            submitText: 'Sign Up'
        }
    },
    init: function() {
        var app = this;

        app.fancySignup();
    }
});

q4App.init();        window.cookieconsent.initialise({
    "palette": {
        "popup": {
            "background": "#edeff5",
            "text": "#60606C"
        },
        "button": {
            "background": "#2B6BE3"
        }
    },
    "content": {
        "message": 'CMS Energy uses cookies on our website as described in our  <a href="https://www.cmsenergy.com/privacy-statement/default.aspx#Question147" target="_blank">Privacy Policy</a>. By continuing to use the site, you agree to the use of cookies.',
        "dismiss": "OK",
        // "link": "Privacy Policy"
        // "href": "https://www.cmsenergy.com/privacy-statement/default.aspx#Question147"
    },
    "elements": {
    //     "messagelink": '<span id="cookieconsent:desc" class="cc-message">Cookies help us deliver our services. You can check &nbsp;<a href="https://www.cmsenergy.com/privacy-statement/default.aspx#Question147" target="_blank">here</a>&nbsp; our privacy policy.</span>'
    	   dismiss: '<a aria-label="OK" role=button tabindex="0" class="cc-btn cc-dismiss">{{dismiss}}</a>',

    },
    // "content": {
    //     "link": 'LINK',
    //     // "target": '_blank',
    //     "dismiss": "Ok",

    // }
});         //<![CDATA[
var Page_ValidationSummaries =  new Array(document.getElementById("_ctrl0_ctl48_validationsummary"));
var Page_Validators =  new Array(document.getElementById("_ctrl0_ctl48_regexEmailValidator1"), document.getElementById("_ctrl0_ctl48_reqvalEmailValidator1"), document.getElementById("_ctrl0_ctl48_cusvalMailingListsValidator"), document.getElementById("_ctrl0_ctl48_cusvalRecaptcha"), document.getElementById("_ctrl0_ctl48_ctl19"));
//]]>  //<![CDATA[
var _ctrl0_ctl48_validationsummary = document.all ? document.all["_ctrl0_ctl48_validationsummary"] : document.getElementById("_ctrl0_ctl48_validationsummary");
_ctrl0_ctl48_validationsummary.headertext = "<p class=\'module_message module_message--error\'>The following errors must be corrected:</p>";
_ctrl0_ctl48_validationsummary.displaymode = "List";
_ctrl0_ctl48_validationsummary.validationGroup = "aebfab06-2c8f-4483-b1d4-76917729c339";
var _ctrl0_ctl48_regexEmailValidator1 = document.all ? document.all["_ctrl0_ctl48_regexEmailValidator1"] : document.getElementById("_ctrl0_ctl48_regexEmailValidator1");
_ctrl0_ctl48_regexEmailValidator1.controltovalidate = "_ctrl0_ctl48_txtEmail";
_ctrl0_ctl48_regexEmailValidator1.errormessage = "Email address is not valid.";
_ctrl0_ctl48_regexEmailValidator1.display = "None";
_ctrl0_ctl48_regexEmailValidator1.enabled = "False";
_ctrl0_ctl48_regexEmailValidator1.evaluationfunction = "RegularExpressionValidatorEvaluateIsValid";
_ctrl0_ctl48_regexEmailValidator1.validationexpression = "^([a-zA-Z0-9_\\-\\.]+)@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.)|(([a-zA-Z0-9\\-]+\\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\\]?)$";
var _ctrl0_ctl48_reqvalEmailValidator1 = document.all ? document.all["_ctrl0_ctl48_reqvalEmailValidator1"] : document.getElementById("_ctrl0_ctl48_reqvalEmailValidator1");
_ctrl0_ctl48_reqvalEmailValidator1.controltovalidate = "_ctrl0_ctl48_txtEmail";
_ctrl0_ctl48_reqvalEmailValidator1.errormessage = "Email address is required.";
_ctrl0_ctl48_reqvalEmailValidator1.display = "None";
_ctrl0_ctl48_reqvalEmailValidator1.validationGroup = "aebfab06-2c8f-4483-b1d4-76917729c339";
_ctrl0_ctl48_reqvalEmailValidator1.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
_ctrl0_ctl48_reqvalEmailValidator1.initialvalue = "";
var _ctrl0_ctl48_cusvalMailingListsValidator = document.all ? document.all["_ctrl0_ctl48_cusvalMailingListsValidator"] : document.getElementById("_ctrl0_ctl48_cusvalMailingListsValidator");
_ctrl0_ctl48_cusvalMailingListsValidator.errormessage = "Mailing list selection is required.";
_ctrl0_ctl48_cusvalMailingListsValidator.display = "None";
_ctrl0_ctl48_cusvalMailingListsValidator.validationGroup = "aebfab06-2c8f-4483-b1d4-76917729c339";
_ctrl0_ctl48_cusvalMailingListsValidator.evaluationfunction = "CustomValidatorEvaluateIsValid";
var _ctrl0_ctl48_cusvalRecaptcha = document.all ? document.all["_ctrl0_ctl48_cusvalRecaptcha"] : document.getElementById("_ctrl0_ctl48_cusvalRecaptcha");
_ctrl0_ctl48_cusvalRecaptcha.errormessage = "The captcha test has failed. Please try again.";
_ctrl0_ctl48_cusvalRecaptcha.display = "None";
_ctrl0_ctl48_cusvalRecaptcha.validationGroup = "aebfab06-2c8f-4483-b1d4-76917729c339";
_ctrl0_ctl48_cusvalRecaptcha.evaluationfunction = "CustomValidatorEvaluateIsValid";
var _ctrl0_ctl48_ctl19 = document.all ? document.all["_ctrl0_ctl48_ctl19"] : document.getElementById("_ctrl0_ctl48_ctl19");
_ctrl0_ctl48_ctl19.controltovalidate = "_ctrl0_ctl48_txtEmail";
_ctrl0_ctl48_ctl19.errormessage = "Email Address is invalid.";
_ctrl0_ctl48_ctl19.display = "None";
_ctrl0_ctl48_ctl19.validationGroup = "aebfab06-2c8f-4483-b1d4-76917729c339";
//]]>      //<![CDATA[

var Page_ValidationActive = false;
if (typeof(ValidatorOnLoad) == "function") {
    ValidatorOnLoad();
}

function ValidatorOnSubmit() {
    if (Page_ValidationActive) {
        return ValidatorCommonOnSubmit();
    }
    else {
        return true;
    }
}
        
theForm.oldSubmit = theForm.submit;
theForm.submit = WebForm_SaveScrollPositionSubmit;

theForm.oldOnSubmit = theForm.onsubmit;
theForm.onsubmit = WebForm_SaveScrollPositionOnSubmit;
//]]>         Q4Login.IframeRedirectURI = "https://login.q4inc.com/authorize?client_id=gKrDY1E9BUSWfU7DGuW2CO4rjdskiNg7&scope=openid+profile+email&response_type=code&response_mode=query&nonce=r5cIhLUGoJ1FTiw8GmEqVJRwAdM&state=eyJhbGciOiJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNobWFjLXNoYTI1NiIsInR5cCI6IkpXVCJ9.eyJyZXR1cm5VcmwiOiJodHRwczovL3d3dy5jbXNlbmVyZ3kuY29tL3E0bG9naW5jYWxsYmFjay5hc3B4IiwiZXhwIjoxNzAyODM4OTIyLjAsImlhdCI6MTY5NzU3OTMyMi4wLCJpc3MiOiJRNC5XZWIuUHVibGljLlNpdGUiLCJhdWQiOiJ1cHN0cmVhbS5jZG4ud2ViLnByZC5xNGluYy5jb20ifQ.U4DoMC_kfVPT2h5Mg1K-I_SIOumuVSeEFL3dDuApILQ&redirect_uri=https%3a%2f%2fauth.platform.q4inc.com%2fauth%2fpublicAuthRedirect&prompt=none";
        (function () {
            if (window.location.hash.includes("login=true")) {
                // q4pid is set in the modal so it should already be there
                const pendoId = window.localStorage.getItem("q4pid");

                // email is also from modal
                const email = window.localStorage.getItem("q4l_email");

                let redirectUrl = $('#hdnRedirectToLoginUrl').val();
                redirectUrl = redirectUrl.replace("_q4pidval_", pendoId);
                redirectUrl = redirectUrl.replace("_q4lemail_", email);

                window.location.replace(redirectUrl);
            }
        })();   